<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ‘‘ Ø®Ø·Ø· Ø§Ù„Ø¹Ø¶ÙˆÙŠØ© Pro</title>

    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    <script src="auth.js"></script>

    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">

    <style>
        :root {
            --primary: #6366f1;
            --accent-gradient: linear-gradient(135deg, #6366f1 0%, #a855f7 100%);
            --bg-body: #0a0f1e;
            --card-bg: rgba(30, 41, 59, 0.7);
            --text-main: #f1f5f9;
            --text-dim: #94a3b8;
            --gold: #ffd700;
            --error: #ef4444;
            --success: #10b981;
        }

        body {
            font-family: 'Cairo', sans-serif;
            background-color: var(--bg-body);
            background-image: radial-gradient(circle at top right, #1e1b4b, transparent), radial-gradient(circle at bottom left, #1e1b4b, transparent);
            color: var(--text-main);
            padding: 20px;
            min-height: 100vh;
            margin: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        /* Ø´Ø±ÙŠØ· Ø§Ù„Ø±Ø¬ÙˆØ¹ ÙˆØ§Ù„Ø¹Ù…Ù„Ø§Øª */
        .nav-header {
            width: 100%;
            max-width: 900px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }

        .home-btn {
            color: var(--text-main);
            text-decoration: none;
            background: rgba(255, 255, 255, 0.05);
            padding: 10px 15px;
            border-radius: 12px;
            border: 1px solid rgba(255,255,255,0.1);
            transition: 0.3s;
        }

        .coin-box {
            background: rgba(255, 215, 0, 0.1);
            padding: 10px 15px;
            border-radius: 12px;
            border: 1px solid var(--gold);
            color: var(--gold);
            font-weight: 900;
        }

        h2 {
            font-weight: 900;
            font-size: 2.2rem;
            background: var(--accent-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }

        .status-banner {
            background: rgba(99, 102, 241, 0.1);
            padding: 12px 25px;
            border-radius: 50px;
            border: 1px solid var(--primary);
            margin-bottom: 30px;
            font-weight: bold;
        }

        /* Ø§Ù„Ø­Ø§ÙˆÙŠØ§Øª ÙˆØ§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª */
        .plans-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 20px;
            width: 100%;
            max-width: 950px;
            margin-bottom: 40px;
        }

        .plan-card {
            background: var(--card-bg);
            backdrop-filter: blur(15px);
            padding: 30px 20px;
            border-radius: 24px;
            border: 1px solid rgba(255,255,255,0.1);
            text-align: center;
            transition: 0.3s;
            position: relative;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .plan-card:hover {
            transform: translateY(-10px);
            border-color: var(--primary);
            box-shadow: 0 15px 30px rgba(0,0,0,0.4);
        }

        .plan-card.best-deal {
            border: 2px solid var(--gold);
            background: rgba(255, 215, 0, 0.05);
        }

        .plan-card h3 {
            font-size: 1.3rem;
            margin-bottom: 15px;
            color: var(--text-main);
        }

        .price {
            font-size: 2.5rem;
            font-weight: 900;
            color: var(--text-main);
            margin: 10px 0;
        }

        .price span {
            font-size: 0.9rem;
            color: var(--text-dim);
            display: block;
            font-weight: normal;
        }

        .buy-button {
            width: 100%;
            padding: 12px;
            border-radius: 12px;
            border: none;
            background: var(--accent-gradient);
            color: white;
            font-weight: bold;
            cursor: pointer;
            transition: 0.3s;
            margin-top: 20px;
        }

        .buy-button:disabled {
            background: #334155;
            cursor: not-allowed;
            opacity: 0.6;
        }

        .discount-badge {
            position: absolute;
            top: -12px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--error);
            color: white;
            padding: 4px 12px;
            border-radius: 50px;
            font-size: 0.8rem;
            font-weight: bold;
            white-space: nowrap;
        }

        /* Ù…Ù…ÙŠØ²Ø§Øª Ø¨Ø±Ùˆ */
        .features-card {
            background: var(--card-bg);
            backdrop-filter: blur(15px);
            padding: 30px;
            border-radius: 24px;
            width: 100%;
            max-width: 500px;
            border: 1px solid rgba(255,255,255,0.1);
            text-align: right;
        }

        .features-list {
            list-style: none;
            padding: 0;
            margin-top: 20px;
        }

        .features-list li {
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 12px;
            color: var(--text-dim);
        }

        .features-list li i {
            color: var(--success);
            font-size: 1.1rem;
        }

    </style>
</head>

<body onload="loadProData()">

<div class="nav-header">
    <div class="coin-box">
        <i class="fas fa-coins"></i> <span id="current-coins-value">0</span>
    </div>
    <a href="index.html" class="home-btn">
        <i class="fas fa-home"></i> Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
    </a>
</div>

<h2>ğŸ‘‘ Ø¹Ø¶ÙˆÙŠØ© Ø¨Ø±Ùˆ (PRO)</h2>
<div id="pro-status" class="status-banner">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ...</div>

<div class="plans-container">
    <div class="plan-card" data-duration-days="7" data-cost="150">
        <h3>Ø§Ù„Ø®Ø·Ø© Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ÙŠØ©</h3>
        <p class="price">150 <span>ÙƒÙˆÙŠÙ†Ø²</span></p>
        <button class="buy-button" onclick="purchasePlan(7, 150)">Ø§Ø´ØªØ±Ùƒ Ø§Ù„Ø¢Ù†</button>
    </div>

    <div class="plan-card" data-duration-days="30" data-cost="450">
        <h3>Ø§Ù„Ø®Ø·Ø© Ø§Ù„Ø´Ù‡Ø±ÙŠØ©</h3>
        <p class="price">450 <span>ÙƒÙˆÙŠÙ†Ø²</span></p>
        <button class="buy-button" onclick="purchasePlan(30, 450)">Ø§Ø´ØªØ±Ùƒ Ø§Ù„Ø¢Ù†</button>
    </div>

    <div class="plan-card" data-duration-days="90" data-cost="1080">
        <div class="discount-badge">Ø®ØµÙ… 20%</div>
        <h3>3 Ø£Ø´Ù‡Ø±</h3>
        <p class="price">1080 <span>ÙƒÙˆÙŠÙ†Ø²</span></p>
        <button class="buy-button" onclick="purchasePlan(90, 1080)">Ø§Ø´ØªØ±Ùƒ Ø§Ù„Ø¢Ù†</button>
    </div>

    <div class="plan-card best-deal" data-duration-days="365" data-cost="2414">
        <div class="discount-badge" style="background: var(--gold); color: #000;">Ø£ÙØ¶Ù„ ØªÙˆÙÙŠØ± 29%</div>
        <h3>Ø§Ù„Ø®Ø·Ø© Ø§Ù„Ø³Ù†ÙˆÙŠØ©</h3>
        <p class="price">2414 <span>ÙƒÙˆÙŠÙ†Ø²</span></p>
        <button class="buy-button" onclick="purchasePlan(365, 2414)">Ø§Ø´ØªØ±Ùƒ Ø§Ù„Ø¢Ù†</button>
    </div>
</div>

<div class="features-card">
    <h3 style="color: var(--gold);"><i class="fas fa-star"></i> Ù…Ø²Ø§ÙŠØ§ Ø§Ù„Ù…Ø´ØªØ±ÙƒÙŠÙ†:</h3>
    <ul class="features-list">
        <li><i class="fas fa-check-circle"></i> ØªÙØ¹ÙŠÙ„ ÙˆØ¶Ø¹ Ø§Ù„ÙÙˆØ¶Ù‰ (Chaos Mode) Ù„Ù„ØºØ±Ù.</li>
        <li><i class="fas fa-check-circle"></i> Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„ÙƒØ§Ù…Ù„ ÙÙŠ ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø£Ø¯ÙˆØ§Ø± ÙŠØ¯ÙˆÙŠØ§Ù‹.</li>
        <li><i class="fas fa-check-circle"></i> Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù…ÙƒØªØ¨Ø© Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ø³Ø±ÙŠØ© Ø§Ù„Ø­ØµØ±ÙŠØ©.</li>
        <li><i class="fas fa-check-circle"></i> Ø´Ø§Ø±Ø© Ø§Ù„ØªØ§Ø¬ Ø§Ù„Ø°Ù‡Ø¨ÙŠØ© Ø¨Ø¬Ø§Ù†Ø¨ Ø§Ø³Ù…Ùƒ ÙÙŠ Ø§Ù„ØºØ±Ù.</li>
        <li><i class="fas fa-check-circle"></i> Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª (Ù…ÙŠØ²Ø© Ù‚Ø§Ø¯Ù…Ø©).</li>
    </ul>
</div>

<script>
let currentUserData = { totalCoins: 0, proExpiryTime: 0 }; 

async function loadProData() {
    firebase.auth().onAuthStateChanged(async (user) => {
        if (!user) {
            window.location.href = "auth.html";
            return;
        }
        
        const data = await loadUserData(); 
        if (data) {
            currentUserData = data;
            displayTotalCoins();
            checkProStatus();
        }
    });
}

function displayTotalCoins() {
    const coinsValue = currentUserData.totalCoins || 0;
    document.getElementById("current-coins-value").innerText = coinsValue;
    
    document.querySelectorAll('.plan-card').forEach(card => {
        const cost = Number(card.getAttribute('data-cost'));
        const button = card.querySelector('.buy-button');
        
        if (coinsValue < cost) {
            button.disabled = true;
            button.innerText = 'Ø±ØµÙŠØ¯ ØºÙŠØ± ÙƒØ§ÙÙ';
        } else {
            button.disabled = false;
            button.innerText = 'Ø§Ø´ØªØ±Ùƒ Ø§Ù„Ø¢Ù†';
        }
    });
}

function checkProStatus() {
    const proExpiryTime = currentUserData.proExpiryTime || 0; 
    const now = new Date().getTime();
    const statusDisplay = document.getElementById("pro-status");

    if (proExpiryTime > now) {
        const remainingDays = Math.ceil((proExpiryTime - now) / (1000 * 60 * 60 * 24));
        statusDisplay.style.color = "var(--gold)";
        statusDisplay.innerHTML = `<i class="fas fa-crown"></i> Ø§Ø´ØªØ±Ø§ÙƒÙƒ ÙØ¹Ø§Ù„! ÙŠÙ†ØªÙ‡ÙŠ Ø¨Ø¹Ø¯: ${remainingDays} ÙŠÙˆÙ….`;
    } else {
        statusDisplay.style.color = "var(--text-dim)";
        statusDisplay.innerHTML = 'ğŸ‘‘ Ø§Ø´ØªØ±Ùƒ ÙÙŠ PRO Ù„ÙØªØ­ Ù…ÙŠØ²Ø§Øª Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„ÙƒØ§Ù…Ù„Ø©';
    }
}

async function purchasePlan(durationDays, cost) {
    if (currentUserData.totalCoins < cost) return;
    
    if (!confirm(`Ø´Ø±Ø§Ø¡ Ø§Ø´ØªØ±Ø§Ùƒ Ù„Ù…Ø¯Ø© ${durationDays} ÙŠÙˆÙ… Ù…Ù‚Ø§Ø¨Ù„ ${cost} ÙƒÙˆÙŠÙ†Ø²ØŸ`)) return;

    const now = new Date().getTime();
    const currentProExpiry = currentUserData.proExpiryTime > now ? currentUserData.proExpiryTime : now;
    const extensionDurationMs = durationDays * 24 * 60 * 60 * 1000;
    const expiryTime = currentProExpiry + extensionDurationMs;
    const newTotalCoins = currentUserData.totalCoins - cost;
    
    const saveSuccessful = await saveUserData({
        totalCoins: newTotalCoins,
        proExpiryTime: expiryTime
    });

    if (saveSuccessful) {
        currentUserData.totalCoins = newTotalCoins;
        currentUserData.proExpiryTime = expiryTime;
        alert(`ØªÙ… Ø§Ù„ØªÙØ¹ÙŠÙ„ Ø¨Ù†Ø¬Ø§Ø­! Ø´ÙƒØ±Ø§Ù‹ Ù„Ø¯Ø¹Ù…Ùƒ.`);
        displayTotalCoins();
        checkProStatus();
    } else {
        alert("Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©ØŒ ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù„Ø§Ø­Ù‚Ø§Ù‹.");
    }
}
</script>

</body>
</html>
